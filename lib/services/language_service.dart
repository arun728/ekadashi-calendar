import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';

class LanguageService extends ChangeNotifier {
  Locale _currentLocale = const Locale('en');

  Locale get currentLocale => _currentLocale;

  LanguageService() {
    _loadLanguage();
  }

  Map<String, String> get localizedStrings => _localizedValues[_currentLocale.languageCode] ?? _localizedValues['en']!;

  static final Map<String, Map<String, String>> _localizedValues = {
    'en': {
      'app_title': 'Ekadashi Calendar',
      'home': 'Home',
      'calendar': 'Calendar',
      'settings': 'Settings',
      'start_fasting': 'Start Fasting',
      'break_fasting': 'Break Fasting',
      'view_details': 'View Details',
      'today': 'Today',
      'tomorrow': 'Tomorrow',
      'passed': 'Passed',
      'in_days': 'in {} days',
      'locating': 'Locating...',
      'detecting_location': 'Detecting Location...',
      'location_denied': 'Location Denied',
      'failed_load': 'Failed to load data',
      'no_ekadashi': 'No Ekadashi on this day',
      'significance': 'Significance',
      'story_history': 'Story and History',
      'fasting_rules': 'Fasting Rules',
      'spiritual_benefits': 'Spiritual Benefits',
      'appearance': 'Appearance',
      'dark_mode': 'Dark Mode',
      'notifications': 'Notifications',
      'enable_notifications': 'Enable Notifications',
      'reminders_active': '{}/4 active',
      'notify_start': 'When Fasting Begins',
      'notify_1day': '1 Day Before',
      'notify_2day': '2 Days Before',
      'notify_parana': 'Break Fasting Reminder',
      'status_active': 'Active',
      'status_disabled': 'Disabled',
      'test_notification': 'Test Notification',
      'test_notification_desc': 'Send a test notification',
      'test_notif_title': 'ЁЯЩП Hari Om!',
      'test_notif_body': 'Your test notification works!',
      'notifications_off': 'Notifications disabled',
      'permissions': 'Permissions',
      'permissions_ok': 'All set',
      'permissions_needed': 'Action needed',
      'alarms_reminders': 'Alarms',
      'alarms_enabled': 'Enabled',
      'alarms_disabled': 'Disabled',
      'battery_optimization': 'Battery',
      'battery_desc': 'Open App Settings',
      'open_settings': 'Open',
      'settings_button': 'Settings',
      'about': 'About',
      'version': 'Version',
      'rate_app': 'Rate App',
      'rate_app_desc': 'Rate us on Play Store',
      'notif_test_title': 'ЁЯЩП Hari Om!',
      'notif_test_body': 'Your test notification works!',
      'notif_2day_title': 'Upcoming Ekadashi',
      'notif_2day_body': 'is in 2 days. Prepare for your fast.',
      'notif_1day_title': 'Ekadashi Tomorrow!',
      'notif_1day_body': 'is tomorrow. Fasting starts at',
      'notif_start_title': 'Ekadashi Starts Now',
      'notif_start_body': 'Today is',
      'notif_start_suffix': 'Fasting begins now.',
      'notif_parana_title': 'Parana Time',
      'notif_parana_body': '- You can break your fast now.',
      'notif_sent_msg': 'Notification sent!',
      // Info dialog translations
      'info_close': 'Got it',
      'alarms_info_title': 'Alarms & Reminders',
      'alarms_info_why': 'Why it\'s needed',
      'alarms_info_why_desc': 'Ekadashi fasting times are based on specific sunrise times. Exact alarms ensure you receive reminders at the precise moment.',
      'alarms_info_steps': 'How to enable',
      'alarms_info_step1': '1. Tap "Open" to go to settings',
      'alarms_info_step2': '2. Toggle "Allow setting alarms" ON',
      'alarms_info_note': 'Note: On some devices, this may already be enabled and cannot be changed.',
      'battery_info_title': 'Battery Optimization',
      'battery_info_why': 'Why it\'s needed',
      'battery_info_why_desc': 'If battery optimization is enabled, Android may delay or skip your Ekadashi reminders to save power.',
      'battery_info_steps': 'How to allow background usage',
      'battery_info_step1': '1. Tap "Open" to go to App Info',
      'battery_info_step2': '2. Tap "Battery" or "App battery usage"',
      'battery_info_step3': '3. Enable "Allow background usage" or select "Unrestricted"',
      'battery_info_note': 'This ensures notifications are delivered on time, even when your phone is idle.',
      // Share translations
      'share_app': 'Share App',
      'share_app_desc': 'Tell friends about this app',
      'share_message': 'ЁЯЩП Ekadashi Calendar - Never miss an Ekadashi!\n\nGet reminders for fasting times, read stories & significance of each Ekadashi.\n\nDownload now: https://play.google.com/store/apps/details?id=com.example.ekadashi_calendar',
      // City selection translations (NEW)
      'select_city': 'Select City',
      'search_city': 'Search city...',
      'auto_detect_location': 'Auto-detect Location',
      'auto_detect_desc': 'Use GPS to find your city',
      'using_auto_location': 'Using auto-detected location',
      'disable_auto_manual': 'Turn off auto-detect to select a city manually',
      'save': 'Save',
      'location': 'Location',
      'change_city': 'Change City',
      // Location permission dialog
      'location_permission_title': 'Location Required',
      'location_permission_permanent': 'Location permission is permanently disabled. Please enable it in App Settings to use location-based features.',
      'cancel': 'Cancel',
      // App Settings (NEW)
      'app_settings': 'App Settings',
      'app_settings_desc': 'Manage permissions & battery',
      'perm_guide_title': 'Permissions Guide',
      'perm_guide_desc': 'For accurate notifications and location features, please allow:\nтАв Notifications\nтАв Location\nтАв Battery (Unrestricted/Background)',
    },

    'ta': {
      'app_title': 'роПроХро╛родроЪро┐ роХро╛ро▓рогрпНроЯро░рпН',
      'home': 'роорпБроХрокрпНрокрпБ',
      'calendar': 'роиро╛роЯрпНроХро╛роЯрпНроЯро┐',
      'settings': 'роЕроорпИрокрпНрокрпБроХро│рпН',
      'start_fasting': 'ро╡ро┐ро░родроорпН роЖро░роорпНрокроорпН',
      'break_fasting': 'ро╡ро┐ро░родроорпН роорпБроЯро┐родрпНродро▓рпН',
      'view_details': 'ро╡ро┐ро╡ро░роЩрпНроХро│рпН',
      'today': 'роЗройрпНро▒рпБ',
      'tomorrow': 'роиро╛ро│рпИ',
      'passed': 'роорпБроЯро┐роирпНродродрпБ',
      'in_days': '{} роиро╛роЯрпНроХро│ро┐ро▓рпН',
      'locating': 'родрпЗроЯрпБроХро┐ро▒родрпБ...',
      'detecting_location': 'роЗро░рпБрокрпНрокро┐роЯроорпН роХрогрпНроЯро▒ро┐родро▓рпН...',
      'location_denied': 'роЗро░рпБрокрпНрокро┐роЯроорпН рооро▒рпБрокрпНрокрпБ',
      'failed_load': 'родро░ро╡рпБ роПро▒рпНро▒ роЗропро▓ро╡ро┐ро▓рпНро▓рпИ',
      'no_ekadashi': 'роЗроирпНрод роиро╛ро│ро┐ро▓рпН роПроХро╛родроЪро┐ роЗро▓рпНро▓рпИ',
      'significance': 'роЪро┐ро▒рокрпНрокрпБ',
      'story_history': 'роХродрпИ рооро▒рпНро▒рпБроорпН ро╡ро░ро▓ро╛ро▒рпБ',
      'fasting_rules': 'ро╡ро┐ро░род ро╡ро┐родро┐роорпБро▒рпИроХро│рпН',
      'spiritual_benefits': 'роЖройрпНроорпАроХ рокро▓ройрпНроХро│рпН',
      'appearance': 'родрпЛро▒рпНро▒роорпН',
      'dark_mode': 'роЗро░рпБрогрпНроЯ рокропройрпНроорпБро▒рпИ',
      'notifications': 'роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН',
      'enable_notifications': 'роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпИ роЗропроХрпНроХрпБ',
      'reminders_active': '{}/4 роЪрпЖропро▓ро┐ро▓рпН',
      'notify_start': 'ро╡ро┐ро░родроорпН родрпКроЯроЩрпНроХрпБроорпНрокрпЛродрпБ',
      'notify_1day': '1 роиро╛ро│рпН роорпБройрпН',
      'notify_2day': '2 роиро╛роЯрпНроХро│рпН роорпБройрпН',
      'notify_parana': 'ро╡ро┐ро░родроорпН роорпБроЯро┐роХрпНроХрпБроорпН роиро┐ройрпИро╡рпВроЯрпНроЯро▓рпН',
      'status_active': 'роЪрпЖропро▓ро┐ро▓рпН',
      'status_disabled': 'роорпБроЯроХрпНроХроорпН',
      'test_notification': 'роЪрпЛродройрпИ роЕро▒ро┐ро╡ро┐рокрпНрокрпБ',
      'test_notification_desc': 'роЪрпЛродройрпИ роЕройрпБрокрпНрокрпБ',
      'test_notif_title': 'ЁЯЩП роЕроЯро┐ропрпЗройрпН',
      'test_notif_body': 'роЙроЩрпНроХро│рпН роЪрпЛродройрпИ роЕро▒ро┐ро╡ро┐рокрпНрокрпБ ро╡рпЗро▓рпИ роЪрпЖропрпНроХро┐ро▒родрпБ!',
      'notifications_off': 'роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН роорпБроЯроХрпНроХроорпН',
      'permissions': 'роЕройрпБроородро┐роХро│рпН',
      'permissions_ok': 'роЪро░ро┐',
      'permissions_needed': 'роЪрпЖропро▓рпН родрпЗро╡рпИ',
      'alarms_reminders': 'роЕро▓ро╛ро░роорпН',
      'alarms_enabled': 'роЗропроХрпНроХроорпН',
      'alarms_disabled': 'роорпБроЯроХрпНроХроорпН',
      'battery_optimization': 'рокрпЗроЯрпНроЯро░ро┐',
      'battery_desc': 'роЖрокрпН роЕроорпИрокрпНрокрпБроХро│рпН',
      'open_settings': 'родро┐ро▒',
      'settings_button': 'роЕроорпИрокрпНрокрпБроХро│рпН',
      'about': 'рокро▒рпНро▒ро┐',
      'version': 'рокродро┐рокрпНрокрпБ',
      'rate_app': 'роОроЩрпНроХро│рпИ роородро┐рокрпНрокро┐роЯрпБ',
      'rate_app_desc': 'рокро┐ро│рпЗ ро╕рпНроЯрпЛро░ро┐ро▓рпН роОроЩрпНроХро│рпИ роородро┐рокрпНрокро┐роЯро╡рпБроорпН',
      'notif_test_title': 'ЁЯЩП роЕроЯро┐ропрпЗройрпН',
      'notif_test_body': 'роЙроЩрпНроХро│рпН роЪрпЛродройрпИ роЕро▒ро┐ро╡ро┐рокрпНрокрпБ ро╡рпЗро▓рпИ роЪрпЖропрпНроХро┐ро▒родрпБ!',
      'notif_2day_title': 'ро╡ро░ро╡ро┐ро░рпБроХрпНроХрпБроорпН роПроХро╛родроЪро┐',
      'notif_2day_body': '2 роиро╛роЯрпНроХро│ро┐ро▓рпН ро╡ро░рпБроХро┐ро▒родрпБ. родропро╛ро░ро╛роХрпБроЩрпНроХро│рпН.',
      'notif_1day_title': 'роиро╛ро│рпИ роПроХро╛родроЪро┐!',
      'notif_1day_body': 'роиро╛ро│рпИ. ро╡ро┐ро░родроорпН родрпКроЯроЩрпНроХрпБроорпН роирпЗро░роорпН:',
      'notif_start_title': 'роПроХро╛родроЪро┐ родрпКроЯроЩрпНроХрпБроХро┐ро▒родрпБ',
      'notif_start_body': 'роЗройрпНро▒рпБ',
      'notif_start_suffix': 'ро╡ро┐ро░родроорпН роЗрокрпНрокрпЛродрпБ родрпКроЯроЩрпНроХрпБроХро┐ро▒родрпБ.',
      'notif_parana_title': 'рокро╛ро░рогрпИ роирпЗро░роорпН',
      'notif_parana_body': '- роЗрокрпНрокрпЛродрпБ ро╡ро┐ро░родродрпНродрпИ роорпБроЯро┐роХрпНроХро▓ро╛роорпН.',
      'notif_sent_msg': 'роЕро▒ро┐ро╡ро┐рокрпНрокрпБ роЕройрпБрокрпНрокрокрпНрокроЯрпНроЯродрпБ!',
      // Info dialog translations
      'info_close': 'роЪро░ро┐',
      'alarms_info_title': 'роЕро▓ро╛ро░роорпН & роиро┐ройрпИро╡рпВроЯрпНроЯро▓рпН',
      'alarms_info_why': 'роПройрпН родрпЗро╡рпИ',
      'alarms_info_why_desc': 'роПроХро╛родроЪро┐ ро╡ро┐ро░род роирпЗро░роЩрпНроХро│рпН роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ роЪрпВро░ро┐роп роЙродроп роирпЗро░родрпНродрпИ роЕроЯро┐рокрпНрокроЯрпИропро╛роХроХрпН роХрпКрогрпНроЯро╡рпИ. роЪро░ро┐ропро╛рой роирпЗро░родрпНродро┐ро▓рпН роиро┐ройрпИро╡рпВроЯрпНроЯро▓рпНроХро│рпН рокрпЖро▒ роЗродрпБ роЙродро╡рпБроХро┐ро▒родрпБ.',
      'alarms_info_steps': 'роЗропроХрпНроХрпБро╡родрпБ роОрокрпНрокроЯро┐',
      'alarms_info_step1': '1. роЕроорпИрокрпНрокрпБроХро│рпБроХрпНроХрпБ "родро┐ро▒" родроЯрпНроЯро╡рпБроорпН',
      'alarms_info_step2': '2. "роЕро▓ро╛ро░роорпН роЕроорпИроХрпНроХ роЕройрпБроородро┐" ON роЪрпЖропрпНропро╡рпБроорпН',
      'alarms_info_note': 'роХрпБро▒ро┐рокрпНрокрпБ: роЪро┐ро▓ роЪро╛родройроЩрпНроХро│ро┐ро▓рпН, роЗродрпБ роПро▒рпНроХройро╡рпЗ роЗропроХрпНроХрокрпНрокроЯрпНроЯро┐ро░рпБроХрпНроХрпБроорпН.',
      'battery_info_title': 'рокрпЗроЯрпНроЯро░ро┐ роЙроХрокрпНрокро╛роХрпНроХроорпН',
      'battery_info_why': 'роПройрпН родрпЗро╡рпИ',
      'battery_info_why_desc': 'рокрпЗроЯрпНроЯро░ро┐ роЙроХрокрпНрокро╛роХрпНроХроорпН роЗропроХрпНроХрокрпНрокроЯрпНроЯро┐ро░рпБроирпНродро╛ро▓рпН, роЙроЩрпНроХро│рпН роПроХро╛родроЪро┐ роиро┐ройрпИро╡рпВроЯрпНроЯро▓рпНроХро│рпН родро╛роородрооро╛роХро▓ро╛роорпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╡ро┐роЯрокрпНрокроЯро▓ро╛роорпН.',
      'battery_info_steps': 'рокро┐ройрпНройрогро┐ рокропройрпНрокро╛роЯрпНроЯрпИ роЕройрпБроородро┐рокрпНрокродрпБ роОрокрпНрокроЯро┐',
      'battery_info_step1': '1. роЖрокрпН родроХро╡ро▓рпБроХрпНроХрпБ "родро┐ро▒" родроЯрпНроЯро╡рпБроорпН',
      'battery_info_step2': '2. "рокрпЗроЯрпНроЯро░ро┐" родроЯрпНроЯро╡рпБроорпН',
      'battery_info_step3': '3. "рокро┐ройрпНройрогро┐ рокропройрпНрокро╛роЯрпНроЯрпИ роЕройрпБроородро┐" роЗропроХрпНроХро╡рпБроорпН роЕро▓рпНро▓родрпБ "ро╡ро░роорпНрокро▒рпНро▒родрпБ" родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН',
      'battery_info_note': 'роЗродрпБ роЙроЩрпНроХро│рпН родрпКро▓рпИрокрпЗроЪро┐ роЪрпЖропро▓ро▒рпНро▒ роиро┐ро▓рпИропро┐ро▓рпБроорпН роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН роЪро░ро┐ропро╛рой роирпЗро░родрпНродро┐ро▓рпН ро╡ро░рпБро╡родрпИ роЙро▒рпБродро┐ роЪрпЖропрпНроХро┐ро▒родрпБ.',
      // Share translations
      'share_app': 'роЖрокрпНрокрпИ рокроХро┐ро░рпН',
      'share_app_desc': 'роирогрпНрокро░рпНроХро│ро┐роЯроорпН рокроХро┐ро░ро╡рпБроорпН',
      'share_message': 'ЁЯЩП роПроХро╛родроЪро┐ роХро╛ро▓рогрпНроЯро░рпН - роТро░рпБ роПроХро╛родроЪро┐ропрпИропрпБроорпН родро╡ро▒ро╡ро┐роЯро╛родрпАро░рпНроХро│рпН!\n\nро╡ро┐ро░род роирпЗро░ роиро┐ройрпИро╡рпВроЯрпНроЯро▓рпНроХро│рпН, роТро╡рпНро╡рпКро░рпБ роПроХро╛родроЪро┐ропро┐ройрпН роХродрпИроХро│рпН & роорпБроХрпНроХро┐ропродрпНродрпБро╡роорпН рокрпЖро▒рпБроЩрпНроХро│рпН.\n\nроЗрокрпНрокрпЛродрпБ рокродро┐ро╡ро┐ро▒роХрпНроХро╡рпБроорпН: https://play.google.com/store/apps/details?id=com.example.ekadashi_calendar',
      // City selection translations (NEW)
      'select_city': 'роироХро░родрпНродрпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпН',
      'search_city': 'роироХро░родрпНродрпИ родрпЗроЯрпБ...',
      'auto_detect_location': 'родро╛ройро┐ропроЩрпНроХро┐ роЗро░рпБрокрпНрокро┐роЯ роХрогрпНроЯро▒ро┐родро▓рпН',
      'auto_detect_desc': 'роЙроЩрпНроХро│рпН роироХро░родрпНродрпИ роХрогрпНроЯро▒ро┐роп GPS рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН',
      'using_auto_location': 'родро╛ройро┐ропроЩрпНроХро┐ роЗро░рпБрокрпНрокро┐роЯроорпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ',
      'disable_auto_manual': 'роХрпИроорпБро▒рпИропро╛роХ родрпЗро░рпНро╡рпБ роЪрпЖропрпНроп родро╛ройро┐ропроЩрпНроХро┐ропрпИ роЕрогрпИроХрпНроХро╡рпБроорпН',
      'save': 'роЪрпЗрооро┐',
      'location': 'роЗро░рпБрокрпНрокро┐роЯроорпН',
      'change_city': 'роироХро░родрпНродрпИ рооро╛ро▒рпНро▒рпБ',
      // Location permission dialog
      'location_permission_title': 'роЗро░рпБрокрпНрокро┐роЯроорпН родрпЗро╡рпИ',
      'location_permission_permanent': 'роЗро░рпБрокрпНрокро┐роЯ роЕройрпБроородро┐ роиро┐ро░роирпНродро░рооро╛роХ роорпБроЯроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роЗро░рпБрокрпНрокро┐роЯ роЕроорпНроЪроЩрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНрод роЖрокрпН роЕроорпИрокрпНрокрпБроХро│ро┐ро▓рпН роЗропроХрпНроХро╡рпБроорпН.',
      'cancel': 'ро░родрпНродрпБ роЪрпЖропрпН',
      // App Settings (NEW)
      'app_settings': 'роЖрокрпН роЕроорпИрокрпНрокрпБроХро│рпН',
      'app_settings_desc': 'роЕройрпБроородро┐роХро│рпН рооро▒рпНро▒рпБроорпН рокрпЗроЯрпНроЯро░ро┐ропрпИ роиро┐ро░рпНро╡роХро┐роХрпНроХро╡рпБроорпН',
      'perm_guide_title': 'роЕройрпБроородро┐ ро╡ро┤ро┐роХро╛роЯрпНроЯро┐',
      'perm_guide_desc': 'родрпБро▓рпНро▓ро┐ропрооро╛рой роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН рооро▒рпНро▒рпБроорпН роЗро░рпБрокрпНрокро┐роЯ роЕроорпНроЪроЩрпНроХро│рпБроХрпНроХрпБ, роЕройрпБроородро┐роХрпНроХро╡рпБроорпН:\nтАв роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпН\nтАв роЗро░рпБрокрпНрокро┐роЯроорпН\nтАв рокрпЗроЯрпНроЯро░ро┐ (ро╡ро░роорпНрокро▒рпНро▒/рокро┐ройрпНройрогро┐)',
    },

    'hi': {
      'app_title': 'рдПрдХрд╛рджрд╢реА рдХреИрд▓реЗрдВрдбрд░',
      'home': 'рд╣реЛрдо',
      'calendar': 'рдХреИрд▓реЗрдВрдбрд░',
      'settings': 'рд╕реЗрдЯрд┐рдВрдЧреНрд╕',
      'start_fasting': 'рд╡реНрд░рдд рдкреНрд░рд╛рд░рдВрдн',
      'break_fasting': 'рд╡реНрд░рдд рдкрд╛рд░рдг',
      'view_details': 'рд╡рд┐рд╡рд░рдг рджреЗрдЦреЗрдВ',
      'today': 'рдЖрдЬ',
      'tomorrow': 'рдХрд▓',
      'passed': 'рдмреАрдд рдЧрдпрд╛',
      'in_days': '{} рджрд┐рдиреЛрдВ рдореЗрдВ',
      'locating': 'рдЦреЛрдЬ рд░рд╣рд╛ рд╣реИ...',
      'detecting_location': 'рд╕реНрдерд╛рди рдкрддрд╛ рд▓рдЧрд╛ рд░рд╣рд╛ рд╣реИ...',
      'location_denied': 'рд╕реНрдерд╛рди рдЕрд╕реНрд╡реАрдХреГрдд',
      'failed_load': 'рдбреЗрдЯрд╛ рд▓реЛрдб рд╡рд┐рдлрд▓',
      'no_ekadashi': 'рдЗрд╕ рджрд┐рди рдПрдХрд╛рджрд╢реА рдирд╣реАрдВ рд╣реИ',
      'significance': 'рдорд╣рддреНрд╡',
      'story_history': 'рдХрдерд╛ рдФрд░ рдЗрддрд┐рд╣рд╛рд╕',
      'fasting_rules': 'рд╡реНрд░рдд рдХреЗ рдирд┐рдпрдо',
      'spiritual_benefits': 'рдЖрдзреНрдпрд╛рддреНрдорд┐рдХ рд▓рд╛рдн',
      'appearance': 'рджрд┐рдЦрд╛рд╡рдЯ',
      'dark_mode': 'рдбрд╛рд░реНрдХ рдореЛрдб',
      'notifications': 'рд╕реВрдЪрдирд╛рдПрдВ',
      'enable_notifications': 'рд╕реВрдЪрдирд╛рдПрдВ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ',
      'reminders_active': '{}/4 рд╕рдХреНрд░рд┐рдп',
      'notify_start': 'рд╡реНрд░рдд рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░',
      'notify_1day': '1 рджрд┐рди рдкрд╣рд▓реЗ',
      'notify_2day': '2 рджрд┐рди рдкрд╣рд▓реЗ',
      'notify_parana': 'рд╡реНрд░рдд рддреЛрдбрд╝рдиреЗ рдХрд╛ рдЕрдиреБрд╕реНрдорд╛рд░рдХ',
      'status_active': 'рд╕рдХреНрд░рд┐рдп',
      'status_disabled': 'рдЕрдХреНрд╖рдо',
      'test_notification': 'рдЯреЗрд╕реНрдЯ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди',
      'test_notification_desc': 'рдЯреЗрд╕реНрдЯ рднреЗрдЬреЗрдВ',
      'test_notif_title': 'ЁЯЩП рд╣рд░рд┐ реР!',
      'test_notif_body': 'рдЖрдкрдХреА рдЯреЗрд╕реНрдЯ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИ!',
      'notifications_off': 'рд╕реВрдЪрдирд╛рдПрдВ рдмрдВрдж',
      'permissions': 'рдЕрдиреБрдорддрд┐рдпрд╛рдВ',
      'permissions_ok': 'рд╕рдм рдареАрдХ',
      'permissions_needed': 'рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЬрд░реВрд░реА',
      'alarms_reminders': 'рдЕрд▓рд╛рд░реНрдо',
      'alarms_enabled': 'рд╕рдХреНрд╖рдо',
      'alarms_disabled': 'рдЕрдХреНрд╖рдо',
      'battery_optimization': 'рдмреИрдЯрд░реА',
      'battery_desc': 'рдРрдк рд╕реЗрдЯрд┐рдВрдЧреНрд╕',
      'open_settings': 'рдЦреЛрд▓реЗрдВ',
      'settings_button': 'рд╕реЗрдЯрд┐рдВрдЧреНрд╕',
      'about': 'рдмрд╛рд░реЗ рдореЗрдВ',
      'version': 'рд╕рдВрд╕реНрдХрд░рдг',
      'rate_app': 'рдРрдк рд░реЗрдЯ рдХрд░реЗрдВ',
      'rate_app_desc': 'рдкреНрд▓реЗ рд╕реНрдЯреЛрд░ рдкрд░ рд╣рдореЗрдВ рд░реЗрдЯ рдХрд░реЗрдВ',
      'notif_test_title': 'ЁЯЩП рд╣рд░рд┐ реР!',
      'notif_test_body': 'рдЖрдкрдХреА рдЯреЗрд╕реНрдЯ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИ!',
      'notif_2day_title': 'рдЖрдЧрд╛рдореА рдПрдХрд╛рджрд╢реА',
      'notif_2day_body': '2 рджрд┐рдиреЛрдВ рдореЗрдВ рд╣реИред рддреИрдпрд╛рд░реА рдХрд░реЗрдВред',
      'notif_1day_title': 'рдХрд▓ рдПрдХрд╛рджрд╢реА!',
      'notif_1day_body': 'рдХрд▓ рд╣реИред рд╡реНрд░рдд рд╢реБрд░реВ:',
      'notif_start_title': 'рдПрдХрд╛рджрд╢реА рдЕрдм рд╢реБрд░реВ',
      'notif_start_body': 'рдЖрдЬ рд╣реИ',
      'notif_start_suffix': 'рд╡реНрд░рдд рдЕрдм рд╢реБрд░реВред',
      'notif_parana_title': 'рдкрд╛рд░рдг рдХрд╛ рд╕рдордп',
      'notif_parana_body': '- рдЕрдм рд╡реНрд░рдд рддреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред',
      'notif_sent_msg': 'рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рднреЗрдЬрд╛ рдЧрдпрд╛!',
      // Info dialog translations
      'info_close': 'рд╕рдордЭ рдЧрдпрд╛',
      'alarms_info_title': 'рдЕрд▓рд╛рд░реНрдо рдФрд░ рд░рд┐рдорд╛рдЗрдВрдбрд░',
      'alarms_info_why': 'рдпрд╣ рдХреНрдпреЛрдВ рдЬрд░реВрд░реА рд╣реИ',
      'alarms_info_why_desc': 'рдПрдХрд╛рджрд╢реА рд╡реНрд░рдд рдХрд╛ рд╕рдордп рд╡рд┐рд╢реЗрд╖ рд╕реВрд░реНрдпреЛрджрдп рд╕рдордп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред рд╕рдЯреАрдХ рдЕрд▓рд╛рд░реНрдо рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рд╕рд╣реА рд╕рдордп рдкрд░ рд░рд┐рдорд╛рдЗрдВрдбрд░ рдорд┐рд▓реЗред',
      'alarms_info_steps': 'рдХреИрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ',
      'alarms_info_step1': '1. рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкрд░ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП "рдЦреЛрд▓реЗрдВ" рдЯреИрдк рдХрд░реЗрдВ',
      'alarms_info_step2': '2. "рдЕрд▓рд╛рд░реНрдо рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐" ON рдХрд░реЗрдВ',
      'alarms_info_note': 'рдиреЛрдЯ: рдХреБрдЫ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░, рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред',
      'battery_info_title': 'рдмреИрдЯрд░реА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝реЗрд╢рди',
      'battery_info_why': 'рдпрд╣ рдХреНрдпреЛрдВ рдЬрд░реВрд░реА рд╣реИ',
      'battery_info_why_desc': 'рдЕрдЧрд░ рдмреИрдЯрд░реА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝реЗрд╢рди рд╕рдХреНрд╖рдо рд╣реИ, рддреЛ Android рдЖрдкрдХреЗ рдПрдХрд╛рджрд╢реА рд░рд┐рдорд╛рдЗрдВрдбрд░ рдореЗрдВ рджреЗрд░реА рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЫреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИред',
      'battery_info_steps': 'рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗрдВ',
      'battery_info_step1': '1. рдРрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП "рдЦреЛрд▓реЗрдВ" рдЯреИрдк рдХрд░реЗрдВ',
      'battery_info_step2': '2. "рдмреИрдЯрд░реА" рдкрд░ рдЯреИрдк рдХрд░реЗрдВ',
      'battery_info_step3': '3. "рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдЙрдкрдпреЛрдЧ рдЕрдиреБрдорддрд┐ рджреЗрдВ" рд╕рдХреНрд╖рдо рдХрд░реЗрдВ рдпрд╛ "рдЕрдкреНрд░рддрд┐рдмрдВрдзрд┐рдд" рдЪреБрдиреЗрдВ',
      'battery_info_note': 'рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХрд╛ рдлреЛрди рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реЛрдиреЗ рдкрд░ рднреА рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рд╕рдордп рдкрд░ рдЖрдПрдВред',
      // Share translations
      'share_app': 'рдРрдк рд╢реЗрдпрд░ рдХрд░реЗрдВ',
      'share_app_desc': 'рджреЛрд╕реНрддреЛрдВ рдХреЛ рдмрддрд╛рдПрдВ',
      'share_message': 'ЁЯЩП рдПрдХрд╛рджрд╢реА рдХреИрд▓реЗрдВрдбрд░ - рдХреЛрдИ рдПрдХрд╛рджрд╢реА рди рдЫреВрдЯреЗ!\n\nрд╡реНрд░рдд рдХреЗ рд╕рдордп рдХреА рдпрд╛рдж рджрд┐рд▓рд╛рдПрдВ, рд╣рд░ рдПрдХрд╛рджрд╢реА рдХреА рдХрдерд╛рдПрдВ рдФрд░ рдорд╣рддреНрд╡ рдкрдврд╝реЗрдВред\n\nрдЕрднреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ: https://play.google.com/store/apps/details?id=com.example.ekadashi_calendar',
      // City selection translations (NEW)
      'select_city': 'рд╢рд╣рд░ рдЪреБрдиреЗрдВ',
      'search_city': 'рд╢рд╣рд░ рдЦреЛрдЬреЗрдВ...',
      'auto_detect_location': 'рд╕реНрдерд╛рди рд╕реНрд╡рддрдГ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ',
      'auto_detect_desc': 'рдЕрдкрдирд╛ рд╢рд╣рд░ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП GPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ',
      'using_auto_location': 'рд╕реНрд╡рддрдГ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╕реНрдерд╛рди рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ',
      'disable_auto_manual': 'рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдГ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдмрдВрдж рдХрд░реЗрдВ',
      'save': 'рд╕реЗрд╡ рдХрд░реЗрдВ',
      'location': 'рд╕реНрдерд╛рди',
      'change_city': 'рд╢рд╣рд░ рдмрджрд▓реЗрдВ',
      // Location permission dialog
      'location_permission_title': 'рд╕реНрдерд╛рди рдЖрд╡рд╢реНрдпрдХ',
      'location_permission_permanent': 'рд╕реНрдерд╛рди рдЕрдиреБрдорддрд┐ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИред рд╕реНрдерд╛рди-рдЖрдзрд╛рд░рд┐рдд рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдРрдк рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред',
      'cancel': 'рд░рджреНрдж рдХрд░реЗрдВ',
      // App Settings (NEW)
      'app_settings': 'рдРрдк рд╕реЗрдЯрд┐рдВрдЧреНрд╕',
      'app_settings_desc': 'рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдФрд░ рдмреИрдЯрд░реА рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░реЗрдВ',
      'perm_guide_title': 'рдЕрдиреБрдорддрд┐ рдЧрд╛рдЗрдб',
      'perm_guide_desc': 'рд╕рдЯреАрдХ рд╕реВрдЪрдирд╛рдУрдВ рдФрд░ рд╕реНрдерд╛рди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЕрдиреБрдорддрд┐ рджреЗрдВ:\nтАв рд╕реВрдЪрдирд╛рдПрдВ\nтАв рд╕реНрдерд╛рди\nтАв рдмреИрдЯрд░реА (рдЕрдкреНрд░рддрд┐рдмрдВрдзрд┐рдд/рдкреГрд╖реНрдарднреВрдорд┐)',
    }
  };

  String translate(String key) {
    return _localizedValues[_currentLocale.languageCode]?[key] ??
        _localizedValues['en']?[key] ??
        key;
  }

  String translateWithArgs(String key, List<String> args) {
    String text = translate(key);
    for (var arg in args) {
      text = text.replaceFirst('{}', arg);
    }
    return text;
  }

  Future<void> _loadLanguage() async {
    final prefs = await SharedPreferences.getInstance();
    final String? languageCode = prefs.getString('language_code');
    if (languageCode != null) {
      _currentLocale = Locale(languageCode);
      notifyListeners();
    }
  }

  Future<void> changeLanguage(String languageCode) async {
    final prefs = await SharedPreferences.getInstance();
    await prefs.setString('language_code', languageCode);
    _currentLocale = Locale(languageCode);
    notifyListeners();
  }
}